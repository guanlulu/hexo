---
title: Mysql数据库
---

#### 遇到的错误

1. Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)

   解决方法： 运行 `mysql.server start`

2. mysql.server start：command not found

   解决方法： `mysql.server ` 在  `/usr/local/mysql/support-files` 下，所以也要配置环境变量，我配置的是 `~/.bash_profile` 这个文件

   ![env](https://cdn-images-1.medium.com/max/800/1*RDfn0UiBjJ0LzIPwWSbk1A.png)

参考： 

* [cant-connect-to-local-mysql-server-through-socket-tmp-mysql-sock-2](https://stackoverflow.com/questions/22436028/cant-connect-to-local-mysql-server-through-socket-tmp-mysql-sock-2)
* [Installing and running MySQL on macOS with errors resolved](https://medium.com/@jainakansha/installing-and-running-mysql-on-macos-with-errors-resolved-70ef53e3b5b9)



#### 终端运行

1. 打开mysql

   ```bash
   sudo mysql -u root -p
   ```

   按回车之后会让输入密码

2. 查看database

   ```bash
   mysql> show databases;
   ```

3. 选择数据库test_sql

   ```bash
   mysql> use test_sql;
   ```

   会提示 `Database changed`

4. 查看tables

   ```bash
   mysql> show tables;
   ```

5. 创建 table

   ```bash
   mysql> create table test_sql (sid int,sname varchar(10));
   ```



#### nodejs 

1. 链接数据库（准备工作，必不可少）

   ```js
   var mysql      = require('mysql');
   
   // 连接数据库
   // user/password 根据实际情况而定
   var connection = mysql.createConnection({
     host     : 'localhost',
     user     : 'root',
     password : '123456',
     database : 'mysql'
   });
    
   connection.connect();
   connection.end();
   ```

2. 查询数据

   ```js
   var  sql = 'SELECT * FROM test_sql';
   connection.query(sql,function (err, result) {
       if(err){
         console.log('[SELECT ERROR] - ',err.message);
         return;
       }
   
      console.log('--------------------------SELECT----------------------------');
      console.log(result);
      console.log('------------------------------------------------------------\n\n');  
   });
   ```

3. 插入数据

   ```js
   var  addSql = 'INSERT INTO test_sql(sid,sname) VALUES(2,?)';
   var  addSqlParams = ['alice'];
   
   connection.query(addSql,addSqlParams,function (err, result) {
           if(err){
            console.log('[INSERT ERROR] - ',err.message);
            return;
           }        
    
          console.log('--------------------------INSERT----------------------------');
          //console.log('INSERT ID:',result.insertId);        
          console.log('INSERT ID:',result);        
          console.log('-----------------------------------------------------------------\n\n');  
   });
   ```

4. 更新数据

   ```js
   var modSql = 'UPDATE test_sql SET sname = ? WHERE sid = ?';
   var modSqlParams = ['bob',0];
   
   connection.query(modSql,modSqlParams,function (err, result) {
      if(err){
            console.log('[UPDATE ERROR] - ',err.message);
            return;
      }        
     console.log('--------------------------UPDATE----------------------------');
     console.log('UPDATE affectedRows',result.affectedRows);
     console.log('-----------------------------------------------------------------\n\n');
   });
   ```

5. 删除数据

   ```js
   var delSql = 'DELETE FROM test_sql where sid=0';
   
   connection.query(delSql,function (err, result) {
           if(err){
             console.log('[DELETE ERROR] - ',err.message);
             return;
           }        
    
          console.log('--------------------------DELETE----------------------------');
          console.log('DELETE affectedRows',result.affectedRows);
          console.log('-----------------------------------------------------------------\n\n');  
   });
   ```
